# GO语言基础学习

## 一、 概念解析

### 1.1 main包和库包

在 Go 语言中，**`main` 包**和**库包（Library Package）**有本质区别，主要体现在用途、编译方式、文件结构以及代码组织上。以下是详细对比

**1. 用途**

| **特性**     | **`main` 包**                         | **库包（Library Package）**                    |
| ------------ | ------------------------------------- | ---------------------------------------------- |
| **核心作用** | 定义可执行程序的入口（`main()` 函数） | 提供可复用的功能（供其他代码导入使用）         |
| **典型场景** | 命令行工具、服务端程序、独立应用      | 工具库、框架、共享逻辑（如 `fmt`、`net/http`） |

------

**2. 编译方式**

| **特性**     | **`main` 包**                        | **库包**                          |
| ------------ | ------------------------------------ | --------------------------------- |
| **输出结果** | 编译为**可执行文件**（如 `./myapp`） | 编译为**静态库文件**（`.a` 文件） |
| **依赖关系** | 可以依赖其他库包                     | 可以被 `main` 包或其他库包依赖    |
| **编译命令** | `go build` 或 `go run`               | `go build`（生成 `.a` 文件）      |

------

**3. 文件结构**

**`main` 包**

- 必须包含 `func main()` 函数（程序入口）。

- 文件通常放在项目根目录（或 `cmd/` 子目录下，如标准库的 `cmd/go`）。

- 示例结构：

  ```bash
  myapp/
  ├── go.mod          # 模块定义（Go Modules）
  ├── main.go         # package main + main() 函数
  └── utils/          # 可选：存放库包代码
      └── helper.go   # package utils（非 main 包）
  ```

**库包**

- 不允许包含 `main()` 函数。

- 文件通常放在单独的目录中，目录名即包名（如 `utils/` 下的文件声明 `package utils`）。

- 示例结构：

  ```bash
  mylib/
  ├── go.mod          # 模块定义
  ├── utils/          # 库包目录
  │   └── helper.go   # package utils
  └── math/           # 另一个库包
      └── calc.go     # package math
  ```

------

**4. 代码示例对比**

**`main` 包示例**

```go
// main.go
package main
 
import "fmt"
 
func main() {
    fmt.Println("这是一个可执行程序")
}
```

- 运行方式：

  ```bash
  go run main.go  # 直接运行
  go build -o myapp main.go  # 编译为可执行文件
  ./myapp         # 执行
  ```

**库包示例**

```go
// utils/helper.go
package utils
 
func Greet(name string) string {
    return "Hello, " + name
}
```

- 使用方式（在其他`main`包中导入）：

  ```go
  // main.go
  package main
   
  import (
      "fmt"
      "mylib/utils"  // 假设模块名为 mylib
  )
   
  func main() {
      fmt.Println(utils.Greet("Go"))  // 调用库包函数
  }
  ```

------

**5. 关键规则**

1. 唯一性：
   - 一个目录下的所有 `.go` 文件必须属于同一个包（`main` 包或库包 **包名与目录名一致**）。
   - 不能混用 `package main` 和库包声明。
2. 导入限制：
   - 只有 `main` 包能导入库包，库包不能导入 `main` 包（避免循环依赖）。
3. 命名规范：
   - 库包名应简短、无歧义（如 `strconv`、`bytes`）。
   - 避免使用通用名（如 `common`、`base`），推荐用域名前缀（如 `github.com/user/project/utils`）。
4. Go Modules：
   - 使用 `go mod init <module-path>` 初始化模块后，包路径会基于模块名（如 `module github.com/user/myapp`）。

------

**6. 常见问题**

- Q: 为什么我的`main`包导入其他包时报错？

  A: 检查：

  1. 被导入的包是否已通过 `go build` 编译（或使用 `go mod tidy` 自动处理依赖）。
  2. 包路径是否正确（如 `import "myapp/utils"` 而非 `import "./utils"`）。

- **Q**: 如何将库包转为可执行程序？
  **A**: 在库包目录下新建 `main.go` 文件，声明 `package main` 并添加 `main()` 函数，然后编译。

### 1.2 基础类型

| 类型类别     | 具体类型                                                 | 用途与关键说明                                               |
| ------------ | -------------------------------------------------------- | ------------------------------------------------------------ |
| 布尔型       | `bool`                                                   | 表示逻辑真假，仅两个取值：`true`（真）、`false`（假），无其他中间值。 |
| 字符串型     | `string`                                                 | 表示 Unicode 字符序列（如 "abc"），Go 中字符串是**不可变的**（一旦创建不能修改字符内容）。 |
| 有符号整数型 | `int`、`int8`、`int16`、`int32`、`int64`                 | - 带正负号的整数，位数分别为：`int`（随系统）、8 位、16 位、32 位、64 位 - 范围例：`int8` 是 `-128 ~ 127`，`int64` 是 `-9223372036854775808 ~ 9223372036854775807` |
| 无符号整数型 | `uint`、`uint8`、`uint16`、`uint32`、`uint64`、`uintptr` | - 仅表示非负数，位数同对应有符号类型 - `uintptr` 特殊：用于存储内存地址（本质是无符号整数，与指针配合使用） |
| 浮点型       | `float32`、`float64`                                     | 表示小数（浮点数），遵循 IEEE 754 标准： - `float32`：32 位单精度，精度约 6-7 位小数 - `float64`：64 位双精度，精度约 15-17 位小数（Go 中默认用`float64`） |
| 复数型       | `complex64`、`complex128`                                | 表示数学中的复数（实部 + 虚部）： - `complex64`：实部和虚部都是`float32` - `complex128`：实部和虚部都是`float64`（Go 中默认用`complex128`） |

1. `byte`=`uint8`
   - 用途：专门表示「ASCII 字符」（如 'a' 的 ASCII 码是 97，可用`byte(97)`表示），强调 “字符” 语义，而非 “无符号 8 位整数”。
2. `rune`= `int32`
   - 用途：专门表示「Unicode 码位」（如中文字符 “你” 的 Unicode 码位是 20320，可用`rune('你')`获取），解决 ASCII 无法覆盖多语言的问题，是 Go 处理多字符集的核心类型。

- 32 位操作系统：`int`/`uint`/`uintptr` 均为 32 位宽（4 字节）
- 64 位操作系统：`int`/`uint`/`uintptr` 均为 64 位宽（8 字节）

批量定义变量：

```go
var (
    变量名1 类型1 = 初始值1
    变量名2 类型2 = 初始值2
    // ... 更多变量
)
```

- 代码更整洁：多个变量声明集中管理，避免重复写`var`关键字
- 支持不同类型：同一`var ()`块中可声明不同类型的变量（如示例中`bool`、`uint64`、`complex128`共存）

```go
var (
    ToBe   bool       = false       // bool类型
    MaxInt uint64     = 1<<64 - 1   // uint64类型（1左移64位减1，即uint64的最大值）
    z      complex128 = cmplx.Sqrt(-5 + 12i) // complex128类型（复数）
)
```

**复数类型的「使用场景」与标准库（指南代码延伸）**

指南示例中首次引入复数类型，并使用了`math/cmplx`包，这是 Go 处理复数的核心知识点：

1. 复数的表示：Go 中复数用`a + bi`表示，`a`是实部，`b`是虚部（如`-5 + 12i`表示实部 - 5，虚部 12）
2. 标准库依赖：复数的运算（如开方、求模）需借助`math/cmplx`包，示例中`cmplx.Sqrt()`是 “复数开平方” 函数
3. 类型匹配：`cmplx.Sqrt()`返回`complex128`类型，因此变量`z`的类型声明为`complex128`（类型必须匹配，Go 是强类型语言）

`fmt.Printf`的「类型与值打印」占位符（指南输出核心）

指南`main`函数中用`fmt.Printf`打印变量的 “类型 + 值”，涉及两个关键占位符，是 Go 调试和输出的常用语法：

| 占位符 | 功能描述                     | 示例对应（以`ToBe`变量为例） |
| ------ | ---------------------------- | ---------------------------- |
| `%T`   | 打印变量的「类型」           | 输出 `bool`（`ToBe`的类型）  |
| `%v`   | 打印变量的「值」（默认格式） | 输出 `false`（`ToBe`的值）   |

### 